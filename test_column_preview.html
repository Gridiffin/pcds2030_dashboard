<!DOCTYPE html>
<html>
<head>
    <title>Column Live Preview Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../../assets/css/table-structure-designer.css" rel="stylesheet">
    <style>
        .test-container { max-width: 1200px; margin: 20px auto; padding: 20px; }
        .test-section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>Live Column Preview Test</h2>
        
        <div class="test-section">
            <h4>Test 1: Column Animation CSS</h4>
            <p>Testing CSS transitions and animations for columns:</p>
            
            <table class="table table-bordered" id="testTable">
                <thead>
                    <tr>
                        <th>Row</th>
                        <th class="editable-table-column">Existing Column</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>January</td>
                        <td class="editable-table-column">
                            <input type="number" class="form-control form-control-sm text-center" value="100">
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <button class="btn btn-primary" onclick="testAddColumn()">Test Add Column</button>
            <button class="btn btn-warning" onclick="testRemoveColumn()">Test Remove Column</button>
        </div>
        
        <div class="test-section">
            <h4>Test 2: Feedback Animations</h4>
            <button class="btn btn-success" onclick="testColumnAddedFeedback()">Test Column Added Feedback</button>
            <button class="btn btn-info" onclick="testProgressFeedback()">Test Progress Feedback</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function testAddColumn() {
            const table = document.getElementById('testTable');
            const headerRow = table.querySelector('thead tr');
            const bodyRow = table.querySelector('tbody tr');
            
            // Add header
            const th = document.createElement('th');
            th.className = 'editable-table-column column-entering new-column-highlight';
            th.innerHTML = '<strong>New Column</strong><br><small>(number)</small>';
            headerRow.appendChild(th);
            
            // Add body cell
            const td = document.createElement('td');
            td.className = 'editable-table-column column-entering new-column-highlight';
            td.innerHTML = '<input type="number" class="form-control form-control-sm text-center" value="0" autofocus>';
            bodyRow.appendChild(td);
            
            // Trigger animations
            setTimeout(() => {
                th.classList.remove('column-entering');
                td.classList.remove('column-entering');
            }, 50);
            
            setTimeout(() => {
                th.classList.remove('new-column-highlight');
                td.classList.remove('new-column-highlight');
            }, 2000);
            
            showTestFeedback('Column added with animation!', 'success');
        }
        
        function testRemoveColumn() {
            const lastHeaderCol = document.querySelector('#testTable thead tr th:last-child');
            const lastBodyCol = document.querySelector('#testTable tbody tr td:last-child');
            
            if (lastHeaderCol && lastBodyCol) {
                lastHeaderCol.classList.add('column-removing');
                lastBodyCol.classList.add('column-removing');
                
                setTimeout(() => {
                    lastHeaderCol.remove();
                    lastBodyCol.remove();
                    showTestFeedback('Column removed with animation!', 'warning');
                }, 300);
            }
        }
        
        function testColumnAddedFeedback() {
            const feedback = document.createElement('div');
            feedback.className = 'alert alert-success alert-dismissible fade show position-fixed column-added-feedback';
            feedback.style.cssText = 'top: 20px; left: 50%; transform: translateX(-50%); z-index: 9999; min-width: 350px;';
            feedback.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-plus-circle me-2 text-success" style="font-size: 1.2em;"></i>
                    <div>
                        <strong>Column Added!</strong><br>
                        <small>"Test Column" is now available for data entry</small>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(feedback);
            setTimeout(() => feedback.remove(), 5000);
        }
        
        function testProgressFeedback() {
            const progress = document.createElement('div');
            progress.className = 'table-update-progress alert alert-info position-fixed';
            progress.style.cssText = 'top: 80px; right: 20px; z-index: 9999; min-width: 300px;';
            progress.innerHTML = `
                <div class="d-flex align-items-center">
                    <div class="spinner-border spinner-border-sm me-2" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    Updating table structure...
                </div>
            `;
            
            document.body.appendChild(progress);
            setTimeout(() => progress.remove(), 2000);
        }
        
        function showTestFeedback(message, type) {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type} position-fixed`;
            alert.style.cssText = 'bottom: 20px; right: 20px; z-index: 9999;';
            alert.textContent = message;
            document.body.appendChild(alert);
            setTimeout(() => alert.remove(), 3000);
        }
    </script>
</body>
</html>
